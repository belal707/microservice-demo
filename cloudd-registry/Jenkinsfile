node 
{
  checkout scm
	dir('cloudd-registry')
	{
	  stage('Package') 
	  {
	     sh 'mvn clean package -DskipTests'
	  }
	}
  	dir('cloudd-registry')
	{
  		stage('Create Docker Image') 
  		{
    			docker.build("belalansari/cloud:1")
  		}
	}
	dir('cloudd-registry')
	{
		stage('Run Tests') 
  		{
			try 
			{  
				sh "mvn test"
				docker login --password="zamila1234" --username="belalansari"
				docker.build("belalansari/cloud:1").push()
			} catch (error)
			{

			} 
		}	
	}
}
